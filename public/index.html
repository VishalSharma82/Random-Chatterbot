<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Random Chat</title>

<link rel="stylesheet" href="./style.css">
<script src="/socket.io/socket.io.js"></script>
<script src="https://cdn.tailwindcss.com"></script>
</head>

<body class="bg-gradient-to-br from-indigo-600 to-purple-700 min-h-screen flex items-center justify-center">

<div class="w-full max-w-6xl min-h-[92vh] bg-white rounded-2xl shadow-2xl flex overflow-hidden relative">

  <!-- MOBILE PROFILE TOGGLE -->
  <button id="openProfile"
    class="md:hidden absolute top-4 left-4 z-50 bg-indigo-600 text-white px-3 py-2 rounded-lg">
    ‚ò∞
  </button>

  <!-- LEFT PROFILE -->
  <div id="profilePanel"
    class="fixed md:static inset-y-0 left-0 z-40 w-72 md:w-1/3 bg-indigo-700 text-white p-6 flex-col transform -translate-x-full md:translate-x-0 transition-transform duration-300 flex">

    <button id="closeProfile" class="md:hidden mb-4 text-right text-xl">‚úñ</button>

    <h2 class="text-2xl font-bold mb-4">Your Profile</h2>

    <img id="avatarPreview"
      class="w-24 h-24 rounded-full mb-4 border-2 border-white"
      src="https://i.pravatar.cc/150">

    <input id="nameInput"
      class="p-2 rounded text-black mb-3"
      placeholder="Enter your name">

    <select id="gender"
      class="p-2 rounded text-black mb-3">
      <option value="">-- Select Gender --</option>
      <option value="male">Male</option>
      <option value="female">Female</option>
      <option value="other">Other</option>
    </select>

    <input id="searchCode"
      class="p-2 rounded text-black mb-3"
      placeholder="Search by Code (optional)">

    <div class="mt-2 text-sm">
      <p>Your Code</p>
      <p id="yourCode"
        class="font-mono text-lg text-green-300">
        Generating...
      </p>
    </div>

    <button id="startChat"
      class="mt-auto bg-green-500 hover:bg-green-600 transition py-2 rounded text-white font-semibold">
      Start Chat
    </button>

    <h3 class="mt-6 font-semibold text-lg">Friends</h3>
    <ul id="friendsUl" class="mt-2 space-y-1 text-sm"></ul>
  </div>

  <!-- RIGHT CHAT AREA -->
  <div class="flex-1 flex flex-col relative">

    <!-- HEADER -->
    <div class="flex items-center justify-between p-4 bg-gray-100 border-b">
      <div>
        <p id="partnerName" class="font-semibold">Not Connected</p>
        <p id="status" class="text-xs text-gray-500">Idle</p>
      </div>
      <button id="addFriendBtn"
        class="hidden text-red-500 text-2xl">
        ‚ù§Ô∏è
      </button>
    </div>

    <!-- CHAT -->
    <div id="chat" class="flex-1 flex flex-col bg-gray-50">

      <div id="messages"
        class="flex-1 overflow-y-auto p-4 space-y-3">
      </div>

      <p id="typingIndicator"
        class="text-sm text-gray-500 px-4 hidden">
        Stranger is typing...
      </p>

      <!-- INPUT -->
      <div class="flex flex-wrap gap-2 p-3 border-t bg-white sticky bottom-0 z-10">
        <input type="text" id="input"
          class="flex-1 min-w-[150px] p-2 border border-gray-300 rounded-lg"
          placeholder="Type a message...">

        <button id="sendBtn"
          onclick="sendMessage()"
          class="bg-green-500 text-white px-4 py-2 rounded-lg hover:bg-green-600">
          Send
        </button>

        <button id="voiceBtn"
          class="bg-blue-500 text-white px-4 py-2 rounded-lg hover:bg-blue-600">
          üé§
        </button>

        <button id="videoBtn"
          class="bg-purple-500 text-white px-4 py-2 rounded-lg hover:bg-purple-600">
          üìπ
        </button>

        <button id="skipChat"
          class="hidden bg-yellow-500 text-white px-4 py-2 rounded-lg">
          Skip
        </button>

        <button id="exitChat"
          class="hidden bg-red-500 text-white px-4 py-2 rounded-lg">
          Exit
        </button>
      </div>
    </div>
  </div>
</div>

<!-- CALL OVERLAY -->
<div id="callOverlay"
  class="hidden fixed inset-0 bg-black bg-opacity-80 flex flex-col items-center justify-center z-50 p-4">

  <h2 id="callTitle"
    class="text-white text-xl mb-4">
  </h2>

  <video id="remoteVideo" autoplay playsinline
    class="w-[90vw] max-w-xl aspect-video bg-black rounded-lg mb-4">
  </video>

  <video id="localVideo" autoplay muted playsinline
    class="w-32 aspect-video bg-black rounded-lg absolute bottom-6 right-6 border-2 border-white">
  </video>

  <div class="flex gap-3 mt-4 flex-wrap justify-center">
    <button id="acceptCallBtn"
      class="bg-green-500 text-white px-5 py-2 rounded-lg">
      Accept
    </button>
    <button id="rejectCallBtn"
      class="bg-red-500 text-white px-5 py-2 rounded-lg">
      Reject
    </button>
    <button id="endCallBtn"
      class="bg-yellow-500 text-white px-5 py-2 rounded-lg">
      End
    </button>
  </div>
</div>

<script src="./script.js"></script>

<script>
  const openProfile = document.getElementById("openProfile");
  const closeProfile = document.getElementById("closeProfile");
  const profilePanel = document.getElementById("profilePanel");

  openProfile?.addEventListener("click", () => {
    profilePanel.classList.remove("-translate-x-full");
  });

  closeProfile?.addEventListener("click", () => {
    profilePanel.classList.add("-translate-x-full");
  });
</script>

</body>
</html>
